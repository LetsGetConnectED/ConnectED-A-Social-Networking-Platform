<app-dash-nav-auth></app-dash-nav-auth>
<div class="main_context">
   <div class="info_context" *ngIf="role==='USER'">
      <div class="post-body m-auto my-5" *ngFor="let post of posts">
         <div class="post-body-header p-3 ">
            <img [src]="selectedImage" alt="" class="dp"> {{ post.user.firstName }} {{ post.user.lastName }}
         </div>
         <div class="post-body-content" >
            <img [src]="getPostImage(post)" alt="" class="col-12">
         </div>
         <div class="post-body-caption pt-3 ps-3">
            <img [src]="selectedImage" alt="" class="dp"> {{ post.user.firstName }} {{ post.user.lastName }} : {{
            post.caption }}
         </div>
         <div class="post-body-function pt-2">
            <div>
            <label class="likeCounter ms-3">{{post.likes}} like</label>
         </div>
         <div>
            <span class="like mx-3 mt-5" (click)="toggleLike(post.id,post.user.email,post.postDate)"> <i class="bi bi-heart-fill mt-5"
                  [style.color]="isLiked ? 'red' : 'white'"></i></span>
            <span class="comment mx-3 mt-5"><i class="bi bi-chat-left-fill"></i></span>
            <span class="share mx-3 mt-5"><i class="bi bi-share-fill"></i></span>
         </div>
         </div>

         <div class="post-body-cmmnt">
            <input class="cmmnt mx-3 ps-2" #comment>
            <span class="share mx-3 "><i class="bi bi-arrow-right-circle-fill" (click)="postUserComment(post.id,post.user.email,post.date,comment.value)"></i></span>
            <div *ngFor="let comment of post.comments.slice(0, showAllComments ? undefined : 1)" class="text-start">
               <div class="d-flex justify-content-between">
               <div class="py-3 ms-3">{{comment.senderUser.firstName}} {{comment.senderUser.lastName}}: {{ comment.comments }}</div>
               <div class="py-3 me-3"><i class="bi bi-reply-fill" (click)="toggleReply(comment)"></i></div>
            </div>
            <div *ngIf="comment.showReply" class="d-flex align-items-center">
               <input class="form-control mx-3" [(ngModel)]="userComment">
               <button class="btn btn-primary mx-2" (click)="sendUserReply(post,comment)">Send</button>
           </div>
           </div>
           <button class="btn btn-link" (click)="toggleCommentDisplay()">
               {{ showAllComments ? 'Hide comments' : 'Show all comments' }}
           </button>

         </div>
      </div>
   </div>
   <div class="info_context" *ngIf="role==='ADVERTISER'">
      <div class="post-body m-auto my-5" *ngFor="let post of posts">
         <div class="post-body-header p-3 ">
            <img [src]="selectedImage" alt="" class="dp"> {{ post.advertiser.firstName }} {{ post.advertiser.lastName }}
         </div>
         <div class="post-body-content" (click)="redirectToLink(post.link)" >
            <img [src]="getPostImageAdvertiser(post)" alt="" class="col-12">
         </div>
         <div class="post-body-caption pt-3 ps-3">
            <img [src]="selectedImage" alt="" class="dp"> {{ post.advertiser.firstName }} {{ post.advertiser.lastName }} : {{
            post.caption }}  
         </div>
         <div class="link_body pt-2" (click)="redirectToLink(post.link)">
          <label class="buylink ms-3">Buy it at : {{post.link}}</label>
         </div>
         <div class="post-body-function pt-2">
            <div>
            <label class="likeCounter ms-3">{{post.likes}} like</label>
         </div>
            <div>
            <span class="like mx-3 mt-5" (click)="toggleLike(post.id,post.advertiser.email,post.postDate)"> <i class="bi bi-heart-fill mt-5"
                  [style.color]="isLiked ? 'red' : 'white'"></i></span>
            <span class="comment mx-3 mt-5"><i class="bi bi-chat-left-fill"></i></span>
            <span class="share mx-3 mt-5"><i class="bi bi-share-fill"></i></span>
         </div>
         </div>

         <div class="post-body-cmmnt">
            <input class="cmmnt mx-3 ps-2" #comment>
            <span class="share mx-3 "><i class="bi bi-arrow-right-circle-fill" (click)="postComment(post.id,post.advertiser.email,post.postDate,comment.value)"></i></span>
            <div *ngFor="let comment of post.comments.slice(0, showAllComments ? undefined : 1)" class="text-start">
               <div class="d-flex justify-content-between">
               <div class="py-3 ms-3">{{comment.senderUser.firstName}} {{comment.senderUser.lastName}}: {{ comment.comment }}</div>
               <div class="py-3 me-3"><i class="bi bi-reply-fill" (click)="toggleReply(comment)"></i></div>
            </div>
            <div *ngIf="comment.showReply" class="d-flex align-items-center">
               <input class="form-control mx-3" [(ngModel)]="comment.replyText">
               <button class="btn btn-primary mx-2" (click)="sendReply(comment)">Send</button>
           </div>
           </div>
           <button class="btn btn-link" (click)="toggleCommentDisplay()">
               {{ showAllComments ? 'Hide comments' : 'Show all comments' }}
           </button>

         </div>
      </div>
   </div>
</div>